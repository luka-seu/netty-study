# 计算机网络
## 计算机网络之网络层
### 1.网络层的作用
- 网络层用于在网络中选择将数据传输到目的IP地址的路径。
### 2. 网络层的设备
- 最关键的设备：路由器---又称三层交换机
- 路由器用于在网络中选择到目的IP地址的路径
> 路由器和交换机的区别：
> 1. 工作层不同：交换机工作在数据链路层；路由器工作在网络层
> 2. 寻址方式不同：交换机基于MAC地址寻找通信主机；路由器基于IP地址寻找通信主机
> 3. 构成网络不同：连接在交换机的主机构成局域网（不跨网段）；跨网段通信需要通过路由器
### 3. 网络层的协议
- ARP协议； IP协议； ICMP/IGMP协议；
#### 3.1 ARP 协议

- 作用： 用于将IP地址解析成MAC地址。
> IP地址：32位；MAC地址：48位
- 上层（应用层）的数据包经过传输层进行分段传输;之后进入网络层加上目的IP地址和源IP地址封装成包；再进入数据链路层加上源MAC地址和目的MAC地址以及校验序列（FCS）；最后物理层转换成二进制比特流再链路上传输。
- ARP协议就是在网络层工作将IP地址解析成MAC地址。

- **作用原理**：<br/>
  - ARP协议全称叫地址解析协议(Address Resolution Protocol)。在同一局域网内，主机A(209.0.0.5)向和主机B（209.0.0.6）通信。由于数据帧在链路中传输时必须知道目标主机的MAC地址，因此在每一台主机上都会维护一个ARP缓存(ARP cache)，用来保存本网段的IP地址和MAC地址映射表。<br/>


  - 在一开始通信时，A会通过广播的形式在本网段发送广播包，大致内容为“我是主机A，IP地址是209.0.0.5，我想知道IP地址为209.0.0.6的主机的MAC地址”，这个过程称为请求分组；<br/>
  ![ARP协议过程](https://github.com/luka-seu/pictures/blob/network/arp.jpg?raw=true)<br/>


  - 在网段中只有目标主机B会对该请求分组进行响应，称为响应分组。虽然其他主机也会收到请求分组，但是识别到IP地址和自己的不同，所以并不会进行响应。这样主机A就会知道主机B的MAC地址。<br/>
  > 1.请求分组时广播的形式，但响应分组时单播的形式；<br/> 2.请求分组中会携带源主机的MAC地址，这样目标主机B就不用再去获取A的地址


  - 跨网段：源主机与本网段路由器进行通信；由本网段路由器利用ARP协议获取目标网段路由器的MAC地址，再由目标网段路由器利用ARP协议获取目标主机MAC地址，完成通信。也就是说ARP高速缓存中只会存储本网段的IP地址和MAC地址映射。<br/>

  > 为什么不直接用MAC地址通信，还要大费周章利用ARP协议解析IP地址?<br/>
  主要是因为世界上存在制式的网络，导致他们使用不同的MAC地址，这样直接使用MAC地址通信会带来十分复杂的MAC地址转换工作，利用统一的IP地址ARP协议会使这些主机像在一个网络通信一样。<br/>


#### 3.2 ICMP协议
